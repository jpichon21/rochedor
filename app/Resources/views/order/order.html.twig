{% set bodyClass="editions order" %}
{% set bodyBackground = 7 %}
{% block title %}{{ page.title ~ ' ' ~ page.subTitle }} - La Roche d'Or{% endblock %}
{% block metadescription %}<meta name="description" content="{{ page.description }}">{% endblock %}
{% extends 'base.html.twig' %}
{% block stylesheets %}
<link rel="stylesheet" href="{{ asset("assets/css/order.css") }}">
<link rel="stylesheet" href="{{ asset('assets/css/editions.css') }}">
{% endblock %}
{% block content %}
{% include 'parts/loader.html.twig' %}
{% include 'parts/popup.html.twig' %}
<div class="content">
    <div class="left">
        <h1><small>{{ page.title }} </small>{{ page.subTitle }}</h1>
        {% if page.content.intro %}
        <div class="intro">
            {{ 'order.registration.intro'|trans({'%link%': path('calendar-' ~ app.request.locale)}) | raw }}
        </div>
        {% endif %}
        <div class="dropdown">
            <div class="item resume">
                <h2>{{ 'order.summary.title' | trans }}</h2>
                <div class="panel active">
                    <div class="cart-render"></div>
                </div>
                <div class="pure-g">
                    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                        <a href="#continue" class="button continue">{{ 'form.continue.order' | trans | raw }}</a>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                        <a href="{{ localePath('editions-collections', app.request.locale) }}" class="button black">{{ 'form.go.buy' | trans | raw }}</a>
                    </div>
                </div>
            </div>
            <div class="item connection">
                <h2>{{ 'order.registration.one.title' | trans | raw }}</h2>
                <div class="welcome-render">
                    {% if app.user %}
                    <p>{{ 'order.registration.one.body.connected' | trans({ '%name%': app.user.prenom ~ ' ' ~ app.user.nom }) | raw }}</p>
                    <div class="pure-g">
                        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                            <a href="#continue" class="button continue">{{ 'form.continue' | trans | raw }}</a>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                            <a href="#disconnect" class="button black disconnect">{{ 'form.disconnect' | trans | raw }}</a>
                        </div>
                    </div>
                    {% else %}
                    <p>{{ 'order.registration.one.body.disconnected' | trans | raw }}</p>
                    <div class="pure-g">
                        <div class="pure-u-1 pure-u-md-1-4">
                            <a href="#connection" class="button yes">{{ 'form.yes' | trans | raw }}</a>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-4">
                            <a href="#registration" class="button no">{{ 'form.no' | trans | raw }}</a>
                        </div>
                    </div>
                    <div class="panel connection">
                        <h3>{{ 'order.registration.one.title.connection' | trans | raw }}</h3>
                        <form class="pure-g connection">
                            <div class="pure-u-1 pure-u-md-1-2">
                                <input autocomplete="nope" class="input username" required type="text" name="username" placeholder="* {{ 'form.username' | trans | raw }}">
                            </div>
                            <div class="pure-u-1 pure-u-md-1-2">
                                <input autocomplete="nope" class="input password" required type="password" name="password" placeholder="* {{ 'form.password-login' | trans | raw }}">
                            </div>
                            <div class="pure-u-1 pure-u-md-1-4">
                                <input autocomplete="nope" class="input button submit" type="submit" value="{{ 'form.ok' | trans | raw }}">
                            </div>
                        </form>
                        <a class="option" href="#reset">{{ 'form.password.reset'|trans }}</a>
                    </div>
                    <div class="panel registration">
                        <h3>{{ 'order.registration.one.title.registration' | trans | raw }}</h3>
                        <form class="pure-g consent-form-render"></form>
                        <form class="pure-g you-form-render"></form>
                    </div>
                    <div class="panel reset">
                        <h3>{{ 'form.password.reset'|trans|raw }}</h3>
                        <form class="pure-g reset">
                            <div class="pure-u-1 pure-u-md-1">
                                <input autocomplete="nope" class="input email" required type="text" name="email" placeholder="* {{ 'form.email' | trans | raw }}">
                            </div>
                            <div class="pure-u-1 pure-u-md-1">
                                <input autocomplete="nope" class="input firstname" required type="text" name="firstname" placeholder="* {{ 'form.firstname' | trans | raw }}">
                            </div>
                            <div class="pure-u-1 pure-u-md-1">
                                <input autocomplete="nope" class="input lastname" required type="text" name="lastname" placeholder="* {{ 'form.lastname' | trans | raw }}">
                            </div>
                            <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1-3 pure-u-xl-1-2">
                                <!-- Offset -->
                            </div>
                            <div class="pure-u-1 pure-u-md-1-4 pure-u-lg-1-3 pure-u-xl-1-4">
                                <a href="#" class="button cancel input">{{ 'form.cancel' | trans | raw }}</a>
                            </div>
                            <div class="pure-u-1 pure-u-md-1-4 pure-u-lg-1-3 pure-u-xl-1-4">
                                <input autocomplete="nope" class="input button submit" type="submit" value="{{ 'form.ok' | trans | raw }}">
                            </div>
                        </form>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="item card">
                <h2>{{ 'order.registration.two.title' | trans | raw }}</h2>
                <div class="you-render"></div>
                <p><i>{{ 'you.billing' | trans | raw }}</i></p>
                <a href="#" class="modify-you">{{ 'form.update' | trans | raw }}</a>
                <div class="consent-date-render"></div>
                <div class="pure-g">
                    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                        <a href="#continue" class="button continue">{{ 'form.continue' | trans | raw }}</a>
                    </div>
                </div>
                <div class="panel modify">
                    <h3>{{ 'order.registration.two.title.modify.you' | trans | raw }}</h3>
                    <form class="pure-g you-form-render"></form>
                </div>
            </div>
            <div class="item shipping">
                <h2>{{ 'order.registration.three.title' | trans | raw }}</h2>
                <div class="pure-g">
                    <div class="pure-u-1">
                        <select class="select white select-adliv" name="select_adliv">
                            <option value="myAd">{{ 'select.ad.myAd' | trans | raw }}</option>
                            <option value="Other">{{ 'select.ad.other' | trans | raw }}</option>
                            <option value="Roche">{{ 'select.ad.roche' | trans ~ ' ' ~ 'no.shipping' | trans | raw }}</option>
                            <option value="Font">{{ 'select.ad.font' | trans ~ ' ' ~ 'no.shipping' | trans | raw }}</option>
                        </select>
                    </div>
                </div>
                <div class="panel adliv">
                    <form class="form adliv">
                        <div class="adliv-form-render"></div>
                    </form>
                </div>
                <div class="panel delay">
                    <div class="delay-render"></div>
                </div>
                <div class="panel orderGift active">
                    <h3>{{ 'order.registration.choose.gift' | trans | raw }}</h3>
                    <p>{{ 'order.gift.text' | trans | raw }}</p>
                    <form class="form orderGift">
                        <div class="pure-g">
                            <div class="pure-u-1 pure-u-md-1-1">
                                <textarea class="textarea note" name="note" placeholder="{{ 'form.gift' | trans | raw }}"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="pure-g">
                    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
                        <a href="#continue" class="button continue">{{ 'form.continue' | trans | raw }}</a>
                    </div>
                </div>
            </div>
            <div class="item payment">
                <h2>{{ 'order.registration.four.title' | trans | raw }}</h2>
                <div class="panel active">
                    <div class="detailCart-render"></div>
                </div>
                <div class="panel active">
                    <h3>{{ 'order.registration.three.title' | trans | raw }}</h3>
                    <div class="delivery-render"></div>
                </div>
                <div class="panel active">
                    <div class="total-render"></div>
                </div>
                <div class="panel active">
                    <form class="form payment">
                        <h3>{{ 'order.choose.payment' | trans | raw }}</h3>
                        <div class="pure-g">
                            <div class="pure-u-1 pure-u-md-1-2">
                                <select class="select select-modpaie" required>
                                    <option selected disabled value="">{{ 'form.choose.modpaie' | trans | raw }}</option>
                                    <option value="CB">{{ 'select.cb' | trans | raw }}</option>
                                    <option value="PP">{{ 'select.paypal' | trans | raw }}</option>
                                    <option value="CH">{{ 'select.bank-cheque' | trans | raw }}</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="terms-render"></div>
                <div class="pure-g">
                    <div class="pure-u-1">
                        <a href="#pay" class="input button pay disabled">{{ 'validate.order' | trans | raw }}</a>
                    </div>
                    <div class="pure-u-1">
                        <a href="{{ path('order-' ~ app.request.locale) }}" class="button black">{{ 'edition.order.form.go_cart' | trans | raw }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="hole">
    </div>
    <div class="right">
    </div>
</div>
{% endblock %}
{% block javascripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.0/underscore-min.js"></script>
<script>
    const _locale = '{{ currentLocale }}'
    const _cartId =  '{{ cart.id }}'
</script>
{% if app.user %}
<script>
    const _userConData = parseInt('{{app.user.conData}}')
</script>
{% endif %}
<script type="application/json" class="countries-json">
    {{ countries | json_encode() | raw }}
</script>
<script type="text/json" class="preferred-countries-json">
    {{ preferredCountries | json_encode() | raw }}
</script>
<script type="application/json" class="order-json">
    {{ order | raw }}
</script>
<script type="application/json" class="user-json">
    {{ user | raw }}
</script>
<script type="text/template" class="welcome-template">
    <p>{{ 'order.registration.one.body.connected' | trans({ '%name%': '<%= you.prenom %> <%= you.nom %>' }) | raw }}</p>
    <div class="pure-g">
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
            <a href="#continue" class="button continue">{{ 'form.continue' | trans | raw }}</a>
        </div>
        <% if (you.conData === true) { %>
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
            <a href="#disconnect" class="button black disconnect">{{ 'form.disconnect' | trans | raw }}</a>
        </div>
        <% } else { %>
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
            <a href="#retry" class="button black disconnect">{{ 'form.retry' | trans | raw }}</a>
        </div>
        <% }%>
    </div>
</script>
<script type="text/template" class="you-template">
    <div class="you">
        <p>
            <%= _.escape(you.civility) %> <%= _.escape(you.prenom) %> <%= _.escape(you.nom) %><br>
            <% if (you.societe) { %><%= _.escape(you.societe) %><br><% } %>
            <%= _.escape(you.adresse) %><br>
            <%= _.escape(you.cp) %> <%= _.escape(you.ville) %><br>
            <%= _.escape(you.pays) %>
        </p>
    </div>
</script>
<script type="text/template" class="terms-template">
    <% if (you.professionnel) { %>
    <p>{{ 'click.termsPro' | trans({'%link%': localePath('cgv-pro', app.request.locale)}) | raw }}</p>
    <% } else { %>
    <p>{{ 'click.terms' | trans({'%link%': localePath('cgv', app.request.locale)}) | raw }}</p>
    <% } %>
</script>
<script type="text/template" class="delivery-template">
    <% if (delivery.destliv !== 'myAd') { %>
        <p>
            <b>{{ 'order.summary.title.billing' | trans }}</b>
            <%= _.escape(you.civility) %> <%= you.prenom %> <%= you.nom %><br>
            <% if (delivery.adliv.societe) { %><%= delivery.adliv.societe %><br><% } %>
            <%= _.escape(you.adresse) %><br>
            <%= _.escape(you.zipcode) %> <%= _.escape(you.ville) %><br>
            <%= _.escape(you.pays) %>
        </p>
    <% } %>
    <p>
        <% if (delivery.destliv !== 'myAd') { %><b>{{ 'order.summary.title.delivery' | trans }}</b><% } %>
        <%= delivery.adliv.prenom %> <%= delivery.adliv.nom %><br>
        <% if (delivery.adliv.societe) { %><%= delivery.adliv.societe %><br><% } %>
        <% if (delivery.destliv === 'Roche') { %>Librairie de la Roche d'Or<br><% } %>
        <% if (delivery.destliv === 'Font') { %>Librairie des Fontanilles<br><% } %>
        <%= _.escape(delivery.adliv.adresse) %><br>
        <%= _.escape(delivery.adliv.zipcode) %> <%= _.escape(delivery.adliv.city) %><br>
        <%= _.escape(delivery.adliv.paysliv) %>
        <% console.log(delivery) %>
    </p>
</script>
<script type="text/template" class="total-template">
    <h3>{{ 'order.summary.title.total' | trans}}</h3>
    <% if (total.consumerPrice) { %>
    <div class="pure-g">
        <div class="pure-u-1 pure-u-md-11-24">
            <table class="table">
                <thead>
                    <tr>
                        <th class="first">{{ 'table.header.weight' | trans }}</th>
                        <th class="last">{{ 'table.header.total' | trans }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="first">{{ 'table.label.weightOrder' | trans }}</td>
                        <td class="last"><%= total.weightOrder %> g</td>
                    </tr>
                    <tr>
                        <td class="first">{{ 'table.label.packagingWeight' | trans }}</td>
                        <td class="last"><%= total.packagingWeight %> g</td>
                    </tr>
                    <tr>
                        <td class="first">{{ 'table.label.totalWeight' | trans }}</td>
                        <td class="last"><%= total.totalWeight %> g</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="pure-u-1 pure-u-md-2-24">
        </div>
        <div class="pure-u-1 pure-u-md-11-24">
            <table class="table">
                <thead>
                    <tr>
                        <th class="first">{{ 'table.header.price' | trans }}</th>
                        <th class="last">{{ 'table.header.total' | trans }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="first">{{ 'table.label.totalPriceIT' | trans }}</td>
                        <td class="last"><%= parseFloat(total.totalPriceIT).toFixed(2) %> €</td>
                    </tr>
                    <tr>
                        <td class="first">{{ 'table.label.vat' | trans }}</td>
                        <td class="last"><%= parseFloat(total.vat).toFixed(2) %> €</td>
                    </tr>
                    <tr>
                        <td class="first">{{ 'table.label.shippingPriceIT' | trans }}</td>
                        <td class="last"><%= parseFloat(total.shippingPriceIT).toFixed(2) %> €</td>
                    </tr>
                    <tr class="ttc">
                        <td class="first">{{ 'table.label.consumerPriceIT' | trans }}</td>
                        <td class="last"><%= parseFloat(total.consumerPriceIT).toFixed(2) %> €</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <% } else { %>
    <p>{{ 'order.summary.body.total' | trans }}</p>
    <% } %>
</script>
<script type="text/template" class="cart-template">
    <h3>{{ 'order.summary.title.cart' | trans | raw }}</h3>
    {% if cart %}
    <table class="table">
        <thead>
            <tr>
                <th class="first">{{ 'table.header.product' | trans }}</th>
                <th>{{ 'table.header.price.unit' | trans }}</th>
                <th>{{ 'table.header.quantity' | trans }}</th>
                <th>Action</th>
                <th class="last">{{ 'table.header.price.total' | trans }}</th>
            </tr>
        </thead>
        <tbody>
            <% var sum = 0 %>
            <% for (var i = 0; i < product.length; i++) { %>
            <%
                var urlProduct = '{{ url('collection-' ~ app.request.locale, { id: 1 }) }}'
                urlProduct = urlProduct.substring(0,urlProduct.length-1) + product[i].codprd
            %>
            <tr>
                <td class="first" title="<%= product[i].name %>"><a href=<%= urlProduct %>><%= product[i].name %></a></td>
                <td><%= parseFloat(product[i].priceIT) %> €</td>
                <td class="quantity">
                <% if (product[i].quantity > 1) { %>
                    <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct minus" data-action="del">&minus;</a>
                <% } else { %>
                    <i class="minus">&minus;</i>
                <% } %>
                <%= parseFloat(product[i].quantity) %>
                <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct plus" data-action="add">&plus;</a></td>
                <td class="action"><a href="#" data-id="<%= product[i].codprd %>" class="removecartline" data-action="add">Supprimer</a></td>
                <td class="last"><%= parseFloat(product[i].priceIT * product[i].quantity).toFixed(2) %> €</td>
                <% sum = sum + parseFloat(product[i].priceIT * product[i].quantity) %>
            </tr>
            <% } %>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5">
                    <span>{{ 'edition.order.total_ttc'|trans }}</span><%= parseFloat(sum).toFixed(2) %> €
                    <div class="info-total">{{ 'edition.order.info_total'|trans }}</div>
                </td>
            </tr>
        </tfoot>
    </table>
    <div class="table-mobile">
        <% for (var i = 0; i < product.length; i++) { %>
            <div class="product">
                <div class="name" title="<%= product[i].name %>"><%= product[i].name %></div>
                <div class="prices">
                    <span class="ttc"><%= parseFloat(product[i].priceIT) %> €</span>
                </div>
                <div class="quantity">
                    <% if (product[i].quantity > 1) { %>
                        <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct minus" data-action="del">&minus;</a>
                    <% } else { %>
                        <i class="minus">&minus;</i>
                    <% } %>
                    <%= parseFloat(product[i].quantity) %>
                    <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct plus" data-action="add">&plus;</a>
                </div>
                <div class="action"><a href="#" data-id="<%= product[i].codprd %>" class="removecartline" data-action="add">Supprimer</a></div>
                <div class="total"><%= parseFloat(product[i].priceIT * product[i].quantity).toFixed(2) %> €</div>
            </div>
        <% } %>
        <div class="amount"><span>TOTAL TTC</span><%= parseFloat(sum).toFixed(2) %> €</div>
    </div>
    {% else %}
    <p>{{ 'cart.empty'|trans }}</p>
    {% endif %}
</script>
<script type="text/template" class="detailCart-template">
    <h3>{{ 'order.summary.title.cart' | trans | raw }}</h3>
    {% if cart %}
    <table class="table">
        <thead>
            <tr>
                <th class="first">{{ 'table.header.product' | trans }}</th>
                <th>{{ 'table.header.price.ttc' | trans }}</th>
                <th>{{ 'table.header.quantity' | trans }}</th>
                <th>{{ 'table.header.price.prix.ht' | trans }}</th>
                <th>{{ 'table.header.tax.rate' | trans }}</th>
                <th>Action</th>
                <th class="last">{{ 'table.header.price.total' | trans }}</th>
            </tr>
        </thead>
        {% set total = 0 %}
        <tbody>
            <% var sum = 0 %>
            <% for(var i = 0; i < product.length; i++) { %>
            <tr>
                <td class="first" title="<%= product[i].name %>"><%= product[i].name %></td>
                <td><%= parseFloat(product[i].priceIT) %> €</td>
                <td class="quantity">
                <% if (product[i].quantity > 1) { %>
                <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct minus" data-action="del">&minus;</a>
                <% } else { %>
                    <i class="minus">&minus;</i>
                <% } %>
                <%= parseFloat(product[i].quantity) %>
                <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct plus" data-action="add">&plus;</a></td>
                <td><%= parseFloat(product[i].price) %> €</td>
                <td><%= parseFloat(product[i].productTaxRate) %> %</td>
                <td class="action"><a href="#" data-id="<%= product[i].codprd %>" class="removecartline" data-action="add" >Supprimer</a></td>
                <td class="last"><%= parseFloat(product[i].priceIT * product[i].quantity).toFixed(2) %> €</td>
                <% sum = sum + (product[i].priceIT * product[i].quantity) %>
            </tr>
            <% } %>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="7"><span>TOTAL TTC</span><%= parseFloat(sum).toFixed(2) %> €</td>
            </tr>
        </tfoot>
    </table>
    <div class="table-mobile">
        <% for (var i = 0; i < product.length; i++) { %>
            <div class="product">
                <div class="name" title="<%= product[i].name %>"><%= product[i].name %></div>
                <div class="prices">
                    <span class="ttc">{{ 'product.detail.price.ttc'|trans({'%ttc%': '<%= parseFloat(product[i].priceIT) %>' }) | raw }}</span>
                    <span class="ht">{{ 'product.detail.price.ht'|trans({'%ht%': '<%= parseFloat(product[i].price) %>' }) | raw }} <i class="tva">({{ 'table.header.tax.rate' | trans }} <%= parseFloat(product[i].productTaxRate) %> %)</i></span>
                </div>
                <div class="quantity">
                    <% if (product[i].quantity > 1) { %>
                        <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct minus" data-action="del">&minus;</a>
                    <% } else { %>
                        <i class="minus">&minus;</i>
                    <% } %>
                    <%= parseFloat(product[i].quantity) %>
                    <a href="#" data-id="<%= product[i].codprd %>" class="patchproduct plus" data-action="add">&plus;</a>
                </div>
                <div class="action"><a href="#" data-id="<%= product[i].codprd %>" class="removecartline" data-action="add">Supprimer</a></div>
                <div class="total"><%= parseFloat(product[i].priceIT * product[i].quantity).toFixed(2) %> €</div>
            </div>
        <% } %>
        <div class="amount"><span>TOTAL TTC</span><%= parseFloat(sum).toFixed(2) %> €</div>
    </div>
    <% if (country !== 'FR') { %>
        <p><i> {{'order.change.price' | trans | raw}} </i></p>
    <% } %>
    {% else %}
    <p>{{ 'cart.empty'|trans }}</p>
    {% endif %}
</script>
<script type="text/template" class="adliv-form-template">
    <h3>{{ 'order.choose.adliv' | trans | raw }}</h3>
    <div class="pure-g">
        <div class="pure-u-1 pure-u-md-1-2">
            <input class="input prenom" required type="text" name="prenom" value="<%= _.escape(delivery.adliv.prenom) %>" placeholder="* {{ 'form.surname' | trans | raw }}">
        </div>
        <div class="pure-u-1 pure-u-md-1-2">
            <input class="input nom" required type="text" name="nom" value="<%= _.escape(delivery.adliv.nom) %>" placeholder="* {{ 'form.name' | trans | raw }}">
        </div>
        <% if (delivery.destliv == 'Other') { %>
            <div class="pure-u-1 pure-u-md-1">
                <textarea class="textarea adresse" required name="adresse" placeholder="* {{ 'form.address' | trans | raw }}"><%= _.escape(delivery.adliv.adresse) %></textarea>
            </div>
            <div class="pure-u-1 pure-u-md-1-2">
                <input class="input zipcode" required type="text" name="zipcode" value="<%= _.escape(delivery.adliv.zipcode) %>" placeholder="* {{ 'form.zipcode' | trans | raw }}">
            </div>
            <div class="pure-u-1 pure-u-md-1-2">
                <input class="input city" required type="text" name="city" value="<%= _.escape(delivery.adliv.city) %>" placeholder="* {{ 'form.city' | trans | raw }}">
            </div>
            <div class="pure-u-1 pure-u-md-1-2">
                <% var disableCountry = false %>
                <% for (var i = 0; i < countries.length; i++) { %>
                    <% if (delivery.paysliv == countries[i].codpays) { %>
                        <% disableCountry = true %>
                    <% } %>
                <% } %>
                <select class="select country" required name="paysliv" <%= (delivery.destliv == 'Roche' || delivery.destliv == 'Font' || disableCountry) ? 'disabled' : '' %>>
                    <option style="font-family: lato" <%= !disableCountry ? 'selected' : '' %> disabled value="">* {{ 'form.country' | trans | raw }}</option>
                    <% for (var i = 0; i < preferredCountries.length; i++) { %>
                        <% var country = preferredCountries[i] %>
                        <% var selectedCountry = 'FR' %>
                        <% if (_.escape(delivery.paysliv) != '') { selectedCountry = _.escape(delivery.paysliv) } %>
                        <option <%= (selectedCountry == country.codpays) ? 'selected' : '' %> value="<%= country.codpays %>"><%= country.nompays %></option>
                    <% } %>
                    <option disabled>----------</option>
                    <% for (var i = 0; i < countries.length; i++) { %>
                        <% var country = countries[i] %>
                        <% if (country.displiv) { %>
                        <option <%= (delivery.paysliv == country.codpays) ? 'selected' : '' %> value="<%= country.codpays %>"><%= country.nompays %></option>
                        <% } %>
                    <% } %>
                </select>
            </div>
        <% } %>
    </div>
</script>
<script type="text/template" class="delay-template">
    <h3>{{ 'order.delay.title' | trans | raw }}</h3>
    <p>{{ 'order.delay.message'| trans({'%minliv%': '<%= country.minliv %>', '%maxliv%': '<%= country.maxliv %>' })|raw  }}</p>
</script>
<script type="text/template" class="consent-form-template">
    <div class="pure-u-1 pure-u-md-1 newfich-wrapper conData">
        <a href="#" class="input button radio conData <%= (client.conData === true) ? 'checked' : '' %>" >{{ 'consent.data' | trans | raw }}</a>
        <input class="hidden checkbox newfich" value="<%= _.escape(client.conData) %>" name="conData" type="text" >
    </div>
</script>
<script type="text/template" class="you-form-template">
    <input autocomplete="nope" type="hidden" value="<%= client.codcli %>" name="codcli">
    <input autocomplete="nope" type="hidden" value=<%= client.check %> name="check">
    <div class="pure-u-1 pure-u-md-1 newfich-wrapper">
        <a href="#" class="input button radio newfich <%= (client.professionnel === true) ? 'checked' : '' %>" >{{ 'form.pro' | trans | raw }}</a>
        <input class="hidden checkbox newfich" value="<%= _.escape(client.professionnel) %>" name="professionnel" type="text" >
    </div>
    <div class="pure-u-1 pure-u-md-1-2">
        <input autocomplete="nope" class="input societe" type="text" value="<%= _.escape(client.societe) %>" name="societe" placeholder="{{ 'form.societe' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-2">
        <input autocomplete="nope" class="input tvaintra" type="text" value="<%= _.escape(client.tvaintra) %>" name="tvaintra" placeholder="{{ 'form.tvaintra' | trans | raw }}" >
    </div>
    <div class="pure-u-1 pure-u-md-1">
        <hr>
    </div>
    <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1 pure-u-xl-1-3">
        <select class="select civil <%= (client.civil != '') ? 'white' : '' %>" required name="civil">
                <option style="font-family: lato;" <%= (client.civil == '') ? 'selected' : '' %> disabled value="">* {{ 'form.civil' | trans | raw }}</option>
                <% for (var i = 0; i < civilites.length; i++) { %>
                    <option <%= (client.civil == civilites[i]) ? 'selected' : '' %> value="<%= civilites[i] %>"><%= civilites[i] %></option>
                <% } %>
        </select>
    </div>
    <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1 pure-u-xl-1-3">
        <input autocomplete="nope" class="input prenom" required type="text" value="<%= _.escape(client.prenom) %>" name="prenom" placeholder="* {{ 'form.surname' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1 pure-u-xl-1-3">
        <input autocomplete="nope" class="input nom" required type="text" value="<%= _.escape(client.nom) %>" name="nom" placeholder="* {{ 'form.name' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1">
        <textarea class="textarea adresse" required name="adresse" placeholder="* {{ 'form.address' | trans | raw }}"><%= _.escape(client.adresse) %></textarea>
    </div>
    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
        <input autocomplete="nope" class="input cp" required type="text" value="<%= _.escape(client.cp) %>" name="cp" placeholder="* {{ 'form.zipcode' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
        <input autocomplete="nope" class="input ville" required type="text" value="<%= _.escape(client.ville) %>" name="ville" placeholder="* {{ 'form.city' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1 pure-u-xl-1-2">
        <% var countryNotFound = true %>
        <% for (var i = 0; i < countries.length; i++) { %>
            <% if (_.escape(client.pays) == countries[i].codpays) { %>
                <% countryNotFound = false %>
            <% } %>
        <% } %>
        <select class="select pays <%= (_.escape(client.pays) != '') ? 'white' : '' %>" required name="pays">
            <option style="font-family: lato;" <%= countryNotFound ? 'selected' : '' %> disabled value="">* {{ 'form.country' | trans | raw }}</option>
            <% for (var i = 0; i < preferredCountries.length; i++) { %>
            <% var country = preferredCountries[i] %>
            <% var selectedCountry = 'FR' %>
            <% if (_.escape(client.pays) != '') { selectedCountry = _.escape(client.pays) } %>
            <option <%= (selectedCountry == country.codpays) ? 'selected' : '' %> value="<%= country.codpays %>"><%= country.nompays %></option>
            <% } %>
            <option disabled>----------</option>
            <% for (var i = 0; i < countries.length; i++) { %>
                <% var country = countries[i] %>
                <% if (countries[i].displiv) { %>
                <option style="font-family: lato;" <%= (_.escape(client.pays) == country.codpays) ? 'selected' : '' %> value="<%= country.codpays %>"><%= country.nompays %></option>
                <% } %>
            <% } %>
        </select>
    </div>
    <div class="pure-u-1 pure-u-md-1-2">
        <input autocomplete="nope" title="{{ 'form.message.phone_invalid'|trans }}" class="input tel" type="text" pattern="([0-9][\s]?)+" value="<%= _.escape(client.tel) %>" name="tel" placeholder="* {{ 'form.phone' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-2">
        <input autocomplete="nope" title="{{ 'form.message.phone_invalid'|trans }}" class="input mobil" type="text" pattern="([0-9][\s]?)+" value="<%= _.escape(client.mobil) %>" name="mobil" placeholder="* {{ 'form.mobile' | trans | raw }}">
    </div>
    <div class="pure-u-1 pure-u-md-1-2">
        <input autocomplete="nope" class="input email" required type="email" value="<%= _.escape(client.email) %>" name="email" placeholder="* {{ 'form.email' | trans | raw }}">
    </div>
    <% if (client.conData === true) { %>
        <% if (!client.codcli) { %>
        <div class="pure-u-1 pure-u-md-1-2">
            <input autocomplete="nope" class="input username" required type="username" value="<%= _.escape(client.username) %>" name="username" placeholder="* {{ 'form.username' | trans | raw }}">
        </div>
        <% } %>
        <% if (!client.codcli) { %>
        <div class="pure-u-1 pure-u-md-1-2">
            <input autocomplete="nope" class="input password" type="password" name="password" placeholder="* {{ 'form.password' | trans | raw }}">
        </div>
        <% } else { %>
        <div class="pure-u-1 pure-u-md-1-2">
            <input autocomplete="nope" class="input password" type="password" name="password" placeholder="{{ 'form.keep-password' | trans | raw }}">
        </div>
        <% } %>
        <div class="pure-u-1 pure-u-md-1 newfich-wrapper conNews">
            <a href="#" class="input button radio conNews <%= (client.conNews === true) ? 'checked' : '' %>" >{{ 'consent.news' | trans | raw }}</a>
            <input class="hidden checkbox newfich" value="<%= _.escape(client.conNews) %>" name="conNews" type="text" >
        </div>
    <% } %>
    <div class="pure-u-1 pure-u-md-1">
        <hr>
    </div>
    <div class="pure-u-1 pure-u-md-1">
        <textarea class="textarea memocli" name="memocli" placeholder="{{ 'form.memocli' | trans | raw }}"><%= _.escape(client.memocli) %></textarea>
    </div>
    <div class="pure-u-1 pure-u-md-1-4">
        <input autocomplete="nope" class="input button submit" type="submit" value="{{ 'form.submit' | trans | raw }}">
    </div>
</script>
<script src="{{ asset("assets/js/order.js") }}"></script>
{% endblock %}
